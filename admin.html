<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å - –ü–µ–∫–∞—Ä–Ω—è –≤ –•–æ–¥–æ—Å—ñ–≤—Ü—ñ</title>
    <link rel="stylesheet" href="admin-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="admin-container">
        <!-- Header -->
        <header class="admin-header">
            <div class="header-content">
                                    <div class="logo">
                        <img src="logo.jpg" alt="–ü–µ–∫–∞—Ä–Ω—è" class="logo-img">
                        <h1>–ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å</h1>
                        <p style="font-size: 0.9rem; color: #8B7355; margin: 0;">–¢–≤–æ—Ä–µ—Ü—å: @mm.slmn</p>
                        <p id="user-level" style="font-size: 0.8rem; color: #4D372C; margin: 0; font-weight: 500;"></p>
                    </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="previewSite()">
                        <i class="fas fa-eye"></i> –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å–∞–π—Ç
                    </button>
                    <button class="btn btn-primary" onclick="saveChanges()">
                        <i class="fas fa-save"></i> –ó–±–µ—Ä–µ–≥—Ç–∏
                    </button>
                    <button class="btn btn-secondary" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> –í–∏–π—Ç–∏
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Navigation Tabs -->
            <div class="tabs">
                <button class="tab-btn active" data-tab="content">
                    <i class="fas fa-edit"></i> –ö–æ–Ω—Ç–µ–Ω—Ç
                </button>
                <button class="tab-btn" data-tab="menu">
                    <i class="fas fa-utensils"></i> –ú–µ–Ω—é
                </button>
                <button class="tab-btn" data-tab="contact">
                    <i class="fas fa-phone"></i> –ö–æ–Ω—Ç–∞–∫—Ç–∏
                </button>
                <button class="tab-btn" data-tab="settings">
                    <i class="fas fa-cog"></i> –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
                </button>
                <button class="tab-btn" data-tab="admins">
                    <i class="fas fa-users-cog"></i> –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏
                </button>
            </div>

            <!-- Content Tab -->
            <div class="tab-content active" id="content">
                <div class="section">
                    <h3>–ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞</h3>
                    <div class="form-group">
                        <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
                        <input type="text" id="hero-title" value="–°–≤—ñ–∂–∞ –≤–∏–ø—ñ—á–∫–∞ —â–æ–¥–Ω—è" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>–ü—ñ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫</label>
                        <textarea id="hero-subtitle" class="form-textarea">–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ —Ç–∞ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω—ñ —Ä–µ—Ü–µ–ø—Ç–∏ –¥–ª—è –Ω–∞–π–∫—Ä–∞—â–æ–≥–æ —Å–º–∞–∫—É</textarea>
                    </div>
                </div>

                <div class="section">
                    <h3>–ü—Ä–æ –Ω–∞—Å</h3>
                    <div class="form-group">
                        <label>–û–ø–∏—Å</label>
                        <textarea id="about-text" class="form-textarea">–ù–∞—à–∞ –ø–µ–∫–∞—Ä–Ω—è –≤ –•–æ–¥–æ—Å—ñ–≤—Ü—ñ - —Ü–µ –º—ñ—Å—Ü–µ, –¥–µ —Ç—Ä–∞–¥–∏—Ü—ñ—ó –∑—É—Å—Ç—Ä—ñ—á–∞—é—Ç—å—Å—è –∑ —è–∫—ñ—Å—Ç—é. –ú–∏ –≤–∏–ø—ñ–∫–∞—î–º–æ —Å–≤—ñ–∂–∏–π —Ö–ª—ñ–± —Ç–∞ –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å—å–∫—ñ –≤–∏—Ä–æ–±–∏ —â–æ–¥–Ω—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç—ñ–ª—å–∫–∏ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏.</textarea>
                    </div>
                </div>
            </div>

            <!-- Menu Tab -->
            <div class="tab-content" id="menu">
                <div class="section">
                    <h3>–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–µ–Ω—é</h3>
                    <button class="btn btn-primary" onclick="addMenuItem()">
                        <i class="fas fa-plus"></i> –î–æ–¥–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç
                    </button>
                    
                    <div class="menu-items" id="menu-items">
                        <!-- Menu items will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Contact Tab -->
            <div class="tab-content" id="contact">
                <div class="section">
                    <h3>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h3>
                    <div class="form-group">
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="tel" id="phone" value="+380976492525" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>–ê–¥—Ä–µ—Å–∞</label>
                        <input type="text" id="address" value="–≤—É–ª. –§–µ–æ–¥–æ—Å—ñ—è –ü–µ—á–µ—Ä—Å—å–∫–æ–≥–æ, 1, –•–æ–¥–æ—Å—ñ–≤–∫–∞, –ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å, 08173" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>–ì–æ–¥–∏–Ω–∏ —Ä–æ–±–æ—Ç–∏</label>
                        <input type="text" id="hours" value="–©–æ–¥–Ω—è –∑ 08:00 –¥–æ 21:00" class="form-input">
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings">
                <div class="section">
                    <h3>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∞–π—Ç—É</h3>
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞ —Å–∞–π—Ç—É</label>
                        <input type="text" id="site-title" value="–ü–µ–∫–∞—Ä–Ω—è –≤ –•–æ–¥–æ—Å—ñ–≤—Ü—ñ" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>–ö–æ–ª—ñ—Ä —Ç–µ–º–∏</label>
                        <select id="theme-color" class="form-select">
                            <option value="brown">–ö–æ—Ä–∏—á–Ω–µ–≤–∏–π</option>
                            <option value="beige">–ë–µ–∂–µ–≤–∏–π</option>
                            <option value="cream">–ö—Ä–µ–º–æ–≤–∏–π</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Admins Tab -->
            <div class="tab-content" id="admins">
                <div class="section">
                    <h3>–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏</h3>
                    <p>–¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞–≤–∞—Ç–∏ —Ç–∞ –≤–∏–¥–∞–ª—è—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ —Å–∞–π—Ç—É.</p>
                    <button class="btn btn-primary" onclick="window.location.href='admin-users.html'">
                        <i class="fas fa-users-cog"></i> –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal for adding menu items -->
    <div class="modal" id="menu-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–î–æ–¥–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞ –ø—Ä–æ–¥—É–∫—Ç—É</label>
                    <input type="text" id="item-name" class="form-input">
                </div>
                <div class="form-group">
                    <label>–û–ø–∏—Å</label>
                    <textarea id="item-description" class="form-textarea"></textarea>
                </div>
                <div class="form-group">
                    <label>–¶—ñ–Ω–∞ (–≥—Ä–Ω)</label>
                    <input type="number" id="item-price" class="form-input">
                </div>
                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
                    <select id="item-category" class="form-select">
                        <option value="bread">–•–ª—ñ–±</option>
                        <option value="pastry">–í–∏–ø—ñ—á–∫–∞</option>
                        <option value="cakes">–¢–æ—Ä—Ç–∏</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç—É</label>
                    <div class="image-upload-container">
                        <input type="file" id="item-image-file" class="form-input" accept="image/*" onchange="previewImage(this)">
                        <div class="image-preview" id="image-preview">
                            <p>–ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å —Ñ–æ—Ç–æ —Å—é–¥–∏ –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –≤–∏–±–æ—Ä—É</p>
                        </div>
                        <div class="image-options">
                            <label>
                                <input type="radio" name="image-source" value="file" checked> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ –ø—Ä–∏—Å—Ç—Ä–æ—é
                            </label>
                            <label>
                                <input type="radio" name="image-source" value="url"> URL –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
                            </label>
                        </div>
                        <input type="text" id="item-image-url" class="form-input" placeholder="https://example.com/image.jpg" style="display: none;">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button class="btn btn-primary" onclick="saveMenuItem()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </div>
    </div>

    <script src="admin.js"></script>
    <script>
                // Check authentication
        function checkAuth() {
            const isLoggedIn = localStorage.getItem('adminLoggedIn');
            const loginTime = localStorage.getItem('adminLoginTime');
            const currentTime = Date.now();

            // Check if logged in and session is valid (24 hours)
            if (!isLoggedIn || !loginTime || (currentTime - loginTime) > 24 * 60 * 60 * 1000) {
                // Clear invalid session
                localStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminLoginTime');

                // Check if we're on init page
                if (window.location.pathname.includes('init-admin.html')) {
                    return true; // Allow access to init page
                }

                // Redirect to login
                window.location.href = 'admin-login.html';
                return false;
            }
            return true;
        }
        
        // Check auth on page load
        window.addEventListener('load', function() {
            if (!checkAuth()) {
                return;
            }
        });
        
        // Add logout function
        function logout() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('adminLoginTime');
            window.location.href = 'admin-login.html';
        }
        
        // Check admin permissions
        function checkAdminPermissions() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) {
                window.location.href = 'admin-login.html';
                return;
            }
            
            const admins = JSON.parse(localStorage.getItem('admins') || '[]');
            const userAdmin = admins.find(a => a.phone === currentUser.phone);
            
            if (!userAdmin) {
                // If no admins exist, allow access to create first admin
                if (admins.length === 0) {
                    return;
                }
                
                alert('–£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É –¥–æ –∞–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—ñ');
                window.location.href = 'index.html';
                return;
            }
            
            // Hide admin management for moderators
            if (userAdmin.level === 'moderator') {
                const adminsTab = document.querySelector('[data-tab="admins"]');
                if (adminsTab) {
                    adminsTab.style.display = 'none';
                }
            }
        }
        
        // Display user level
        function displayUserLevel() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const userLevelElement = document.getElementById('user-level');
            
            if (currentUser && userLevelElement) {
                const admins = JSON.parse(localStorage.getItem('admins') || '[]');
                const userAdmin = admins.find(a => a.phone === currentUser.phone);
                
                if (userAdmin) {
                    let levelText = '';
                    let levelColor = '';
                    
                    switch(userAdmin.level) {
                        case 'owner':
                            levelText = 'üëë –í–ª–∞—Å–Ω–∏–∫';
                            levelColor = '#FFD700';
                            break;
                        case 'admin':
                            levelText = '‚öôÔ∏è –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä';
                            levelColor = '#4CAF50';
                            break;
                        case 'moderator':
                            levelText = 'üîß –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä';
                            levelColor = '#2196F3';
                            break;
                        default:
                            levelText = 'üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á';
                            levelColor = '#9E9E9E';
                    }
                    
                    userLevelElement.textContent = `${currentUser.name} - ${levelText}`;
                    userLevelElement.style.color = levelColor;
                } else {
                    userLevelElement.textContent = `${currentUser.name} - üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á`;
                    userLevelElement.style.color = '#9E9E9E';
                }
            }
        }
        
        // Check permissions on page load
        window.addEventListener('load', function() {
            if (!checkAuth()) {
                return;
            }
            checkAdminPermissions();
            displayUserLevel();
        });
    </script>
</body>
</html> 